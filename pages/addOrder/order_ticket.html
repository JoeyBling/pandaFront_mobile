<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <!-- 禁用苹果默认样式 -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!-- 作者信息 -->
    <meta name="author" content="name:Geek.Yu,email:1098654043@qq.com">
    <!-- 版权信息 -->
    <meta name="copyright" content="Copyright (c) 2006-2017 Mafengwo.">
    <!-- 禁止ios自动识别手机号和邮箱 -->
    <meta name="format-detection" content="telephone=no,address=no">
    <!-- 熊猫旅行网站关键词 -->
    <meta name="keywords" content="旅游一体化,舒适便捷,熊猫旅行">
    <!-- 熊猫旅行网站描述 -->
    <meta name="description" content="熊猫旅行网(m.pandaFront.com)靠谱的旅游攻略,最佳的自由行,自助游分享社区,海量旅游景点图片、游记、交通、美食、购物等旅游攻略自由行信息.">

    <title>熊猫旅行--门票预订</title>

    <!-- 调用弹性布局的js -->
    <script src="../../js/flexible.js"></script>
    <!-- Framework7 CSS-->
    <link rel="stylesheet" href="../../css/framework7.ios.min.css">
    <!-- iconfont引用 -->
    <link rel="stylesheet" href="../../fonts/iconfont.css">
    <!-- order样式引用 -->
    <link rel="stylesheet" href="../../css/order/order+pay.css">
    <!-- 应用程序的响应式布局样式 -->
    <link rel="stylesheet" href="../../css/app-responsive.css">

  </head>
  <body>

    <div class="view view-main">
        <div class="pages">
            <form>
                <div class="page" data-page="index">
                    <div class="page-content box-sizing toolbar-fixed">
                        <section class="head-info-content border-bottom-solid">
                            <a href="#" data-popup=".ticket-tips" class="open-popup">
                                <div class="content-inner">
                                    <h3 class="subtitle">【嗨翻美食节4.2-4.30】南昌万达主题乐园夜场成人票（小孩半价收费）</h3>
                                    <p class="info">
                                        <span class="unit-money"><em>248</em>/张</span>
                                        <a href="javascript:;">票型说明<i class="icon iconfont icon-iosarrowright"></i></a>
                                    </p>
                                </div>
                            </a>
                        </section><!-- 门票信息 -->
                        <section class="form-group mb-10 border-bottom-solid">
                            <div class="content-inner">
                                <div class="group-item border-bottom-solid">
                                    <span class="subtitle vertical-layout">游玩日期</span>
                                    <section class="time-selection-box vertical-layout clearfix">
                                        <div class="time-block active">
                                            <span>今天</span>
                                            <em>04-11</em>
                                        </div>
                                        <div class="time-block">
                                            <span>明天</span>
                                            <em>04-12</em>
                                        </div>
                                        <div class="time-block more">
                                            <span class="complete-center">更多<br/>日期</span>
                                            <i class="complete-center icon iconfont icon-iosarrowright"></i>
                                        </div>
                                    </section><!-- 时间选择容器 -->
                                </div>
                                <div class="group-item">
                                    <span class="subtitle vertical-layout">数量</span>
                                    <section id="adder-subtractor" class="adder-subtractor vertical-layout">
                                        <span class="subtract vertical-layout">
                                            <i class="icon iconfont icon-jianhao"></i>
                                        </span>
                                        <em class="number">1</em>
                                        <span class="add vertical-layout">
                                            <i class="icon iconfont icon-jiahao1"></i>
                                        </span>
                                    </section><!-- 加减器 -->
                                </div>
                            </div>
                        </section><!-- 列表信息 -->

                        <section class="form-group mb-10">
                            <div class="content-inner">
                                <div class="group-item border-bottom-solid">
                                    <span class="subtitle vertical-layout">出游人</span>
                                    <section class="item-info">
                                        <input placeholder="请填写出游人的姓名" />
                                        <i class="icon iconfont icon-lianxiren extra"></i>
                                    </section><!-- 表单输入框容器 -->
                                </div>
                                <div class="group-item">
                                    <span class="subtitle vertical-layout">手机号</span>
                                    <section class="item-info">
                                        <input placeholder="用于接收确认短信" />
                                    </section><!-- 表单输入框容器 -->
                                </div>
                            </div>
                        </section><!-- 列表信息 -->

                        <section class="form-group mb-10">
                            <a href="#" data-popup=".popup-products-tips" class="open-popup">
                                <div class="content-inner">
                                    <div class="group-item">
                                        <span class="subtitle vertical-layout">购票须知</span>
                                        <section class="item-info">
                                            <i class="icon iconfont icon-iosarrowright extra"></i>
                                        </section><!-- 购票须知 -->
                                    </div>
                                </div>
                            </a>
                        </section><!-- 列表信息 -->

                    </div>

                    <div class="foot-box border-top-solid box-sizing">
                        <section class="box-info">订单金额：<em class="unit-money">248</em></section>
                        <a href="javascript:;" class="agree-btn">提交订单</a>
                    </div><!-- 底部支付信息栏 -->

                    <div class="popup popup-products-tips">
                        <div class="content-block">
                            <p>购票须知</p>
                            <p><a href="#" class="close-popup">关闭</a></p>
                            <p>购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知购票须知</p>
                        </div>
                    </div><!-- 购票须知 -->

                    
                    <div class="popup ticket-tips">
                        <div class="content-block">
                            <p>票型说明</p>
                            <p><a href="#" class="close-popup">关闭</a></p>
                            <p>票型说明票型说明票型说明票型说明票型说明票型说明票型说明票型说明票型说明票型说明</p>
                        </div>
                    </div><!-- 票型说明 -->
                </div>
            </form>
        </div>
    </div><!-- 订单支付页 -->

    <script type="text/template7" id="calendarDom">

        <section class="calendar-modal">
            <div class="calendar-mask complete-center"></div><!-- 遮罩层 -->
            <div class="calendar-content complete-center">
                <section class="box-header-navbar border-bottom-solid">
                    <div class="left icon" data-func="back">
                        <i class="icon iconfont icon-iosarrowleft"></i>
                    </div>
                    <h3 class="center">选择日期</h3>
                    <div class="right"  data-func="complete">
                        <span class="link-title">完成</span>
                    </div>
                </section>
                <section class="calendar-info">
                    <div class="calendar-title clearfix border-bottom-solid box-sizing">
                        <section class="weekend">日</section>
                        <section>一</section>
                        <section>二</section>
                        <section>三</section>
                        <section>四</section>
                        <section>五</section>
                        <section class="weekend">六</section>
                    </div>
                </section>
                <div id="calendar" class="calendar-box"></div>
            </div>
        </section>
        
    </script>  

    
    <!-- 加载 Framework7 脚本-->
    <script type="text/javascript" src="../../js/framework7.min.js"></script>
    <!-- 加载 jq-->
    <script type="text/javascript" src="../../js/jquery.min.js"></script>
    <!-- 加载 velocity 动画序列库-->
    <script type="text/javascript" src="../../js/vendor/velocity.min.js"></script>
    <script type="text/javascript" src="../../js/vendor/velocity.ui.min.js"></script>
    <!-- 加载 移动端日历插件-->
    <script type="text/javascript" src="../../js/calendar/calendar.js"></script>
    <!-- 加载 我的应用程序 搭载的所有插件脚本-->
    <script type="text/javascript" src="../../js/plugins.js"></script>
    
    <script type="text/javascript">
        
        // 初始化 应用程序 framework7
        var myApp = new Framework7({
            init: false,
        });

        // 出口选择器引擎定义
        var $$ = Dom7;

        // 主视图
        var mainView = myApp.addView('.view-main');

        myApp.onPageInit('index', function (page) {
            var $$el,
                $$addSubDom,             // 加减区的Dom
                calendarTemp,            // 日历的template
                $c_modalDom,             // 日历的模态层Dom
                $c_maskDom,              // 日历的遮罩层Dom
                $c_contentDom,           // 日历的内容层Dom
                $c_backLink,             // 日历头部的返回链接
                $c_completeLink,         // 日历头部的完成链接
                oSelectDate,             // 选择的时间值
                calendarIns,             // 日历对象
                calendarDom;             // 日历列表的容器Dom

            $$el = $$(page.container);
            $$addSubDom = $$el.find("#adder-subtractor");
            
            // 调用加减计算方法
            $("#adder-subtractor").choicesNUM({
                longPressTime : 250,         // 触发长按的时间
                maximum : 25,                // 数值选择器的最大数值
                maxPrompt: "嘻嘻，已达上限哟~~",         // 选择器达上限的提示语
                minPrompt: "嘻嘻，数量不能低于0呦~~",    // 选择器达下限的提示语
            });

            // 今日明日选中高亮切换
            $(".time-block:not(.more)").on("touchstart",function(){
                $(this).addClass("active").siblings(".time-block:not(.more)").removeClass("active");
            });
            
            // 初始化给页面增加日历的DOM
            calendarTemp = $('script#calendarDom').html();
            $("body").append(calendarTemp);

            $c_modalDom = $('.calendar-modal');
            $c_maskDom = $c_modalDom.find('.calendar-mask');
            $c_contentDom = $c_modalDom.find('.calendar-content');
            $c_backLink = $c_modalDom.find('[data-func=back]');
            $c_completeLink = $c_modalDom.find('[data-func=complete]');
            
            calendarIns = new calendar.calendar( {
                el: '#calendar',
                count: 4,
                selectDate: new Date(),
                selectDateName: '入住',
                minDate: new Date(),
                maxDate: new Date( +new Date() + 100 * 86400000 ),
                isShowHoliday: true,
                isShowWeek: false
            });

            // 定义打开日历的序列函数方法
            var calendarOpen = [
                { e: $c_modalDom, p: { opacity: 1 }, o: {  delay: 0, duration: 0, display: "block" } },
                { e: $c_maskDom, p: { opacity: 1 }, o: {  delay: 0, duration: 400, easing: [ .2,1.14,.65,1.5 ], display: "block", sequenceQueue: false } },
                { e: $c_contentDom, p: { translateX: "100%" }, o: { delay: 0, duration: 0, display: "block", sequenceQueue: false } },
                { e: $c_contentDom, p: { translateX: 0 }, o: { delay: 0, duration: 400, easing: [ 0, 0, 0.2, 1 ], sequenceQueue: false } },
            ];

            // 定义关闭日历的序列函数方法
            var calendarClose = [
                { e: $c_contentDom, p: "reverse", o: { delay: 0, duration: 300, easing: [ .2,1.14,.65,1.5 ], display: "none", sequenceQueue: false } },
                { e: $c_maskDom, p: "reverse", o: {  delay: 0, duration: 300, easing: [ .2,1.14,.65,1.5 ], display: "none", sequenceQueue: false } },
                { e: $c_modalDom, p: "reverse", o: {  delay: 0, duration: 300, easing: [ .2,1.14,.65,1.5 ], display: "none" } },
            ];

            // 更多日期 || 打开日历
            $(".time-block.more").on("touchstart",function(){
                openCalendar();
            });
            
            // 日历页的返回按钮
            $c_backLink.on("touchstart",function(){
                closeCalendar();
            });

            $c_completeLink.on("touchstart",function(){
                var _dateVal = oSelectDate.replace(/^\d{4}-{1}/,'');
                // 是否已经存在创建的DOM
                var isExist = $("section.time-selection-box >div").hasClass("creat-block");
                if(!isExist){
                    var _tplDom = '<div class="time-block creat-block">'+
                                 '<span>已选</span>'+
                                  '<em>'+_dateVal+'</em>'+
                            '</div>'
                    $(".time-block.more").before(_tplDom);
                }else{
                    $("section.time-selection-box div.creat-block").html('<span>已选</span><em>'+_dateVal+'</em>')
                }
                // 今日明日选中高亮切换
                $(".time-block:not(.more)").on("touchstart",function(){
                    $(this).addClass("active").siblings(".time-block:not(.more)").removeClass("active");
                });
                // 给选择的日期高亮
                $("section.time-selection-box div.creat-block").addClass("active").siblings(".time-block:not(.more)").removeClass("active");
                // 关闭日历
                closeCalendar();
            });
            
            calendarDom = $((calendarIns.el.selector).toString());
            calendarDom.bind('afterSelectDate', function( e, val ) {
                var curItem = val.curItem,
                    date = val.date,
                    dateName = val.dateName;

                oSelectDate = date;
            });
            
            // 将$ .Velocity.mock设置为任意乘数，以加快或减慢页面上的所有动画
            $.Velocity.mock = 1;

            // 启用日期
            function openCalendar(){
                $.Velocity.RunSequence(calendarOpen);
            }

            // 关闭日历
            function closeCalendar(){
                $.Velocity.RunSequence(calendarClose);
            }

        });

        //初始化app
        myApp.init();
    </script>

  </body>
</html>